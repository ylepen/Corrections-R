---
title: "Chapitre II"
output:
  pdf_document: default
  html_document:
    df_print: paged
---


# Exercice sur le PIB des Etats-Unis

## Importation et visualisation des données


On importe les données trimestrielles du taux de chômage aux Etats-Unis du 01/01/1994 au 23/01/01 (117 observations). Les données sont importées du site db.nomics. Les données proviennent du ``Bureau of Labor Statistics''. On leur importe en utilisant leur identifiant ids. 

```{r}
library(data.table)
library(rdbnomics)

df<-rdb(ids = "BLS/ln/LNS13327708Q")
class(df)
str(df)
```

On crée un dataframe contenant uniquement les dates et la série du taux de chômage.
```{r}
df_us<-df[,c("period","value")]
colnames(df_us)<-c('Date','taux')
```

```{r}
head(df_us)
```


```{r}
tail(df_us)
```

Le graphique montre que le taux de chômage aux Etats-Unis fluctue autour de 6\% du début de l'échantillon jusqu'à l'année 2008 à partir de laquelle il augmente très rapidement jusqu'au niveau de 11\%, sous l'effet de la crise des subprimes. On observe aussi l'épisode de la crise du Covid avec une hausse instantanée du taux de chômage autour de 14\% suivie d'un retour rapide à des niveaux très bas. La période du covid peut avoir un impact sur les résultats des tests statistiques. Au vu du graphique, il est assez difficile de trancher sur la stationnarité du taux de chômage.

```{r}
library(ggplot2)
p_us<-ggplot(data=df_us,aes(x=Date,y=taux))+geom_point(color='red')+geom_line(color='red')+xlab('Date')+ylab('Taux de chômage')+ggtitle('Taux de chômage aux Etats-Unis - 1994/01/01 à 2023/01/01')+theme(plot.title = element_text(hjust = 0.5))
p_us
```
## Autocorrélogramme du taux de chômage

```{r}
acf_us_rate<-acf(x=df_us$taux,main='Autocorrélogramme du taux de chômage des Etats-Unis')
acf_us_rate$acf
```
On observe que l'autocorrélation est supérieure à 0.5 jusqu'à l'ordre 4, ce qui est plutôt élevé. Elle n'est plus significative, pour un risque de première espèce de 5%, à partir de l'ordre 11. L'autocorrélogramme du taux de chômage serait compatible avec celui d'un processus stationnaire. 

```{r}
pacf(x=df_us$taux,main='Autocorrélogramme partiel du taux de chômage des Etats-Unis')
```
Aucune autocorrélation partielle n'est significativement différente de 0. L'autocorrélogramme et l'autocorrélogramme partiel nous suggère que le taux de chômage pourrait être modélisé par un processus AR(p).


# Test de Dickey-Fuller augmenté

## Test ADF avec constante et tendance déterministe
On applique le test ADF avec une tendance déterministe. Le nombre de retards maximum est fixé à 8 et le nombre de retards optimal est déterminé par la minimisation du critère AIC.
```{r}
library(urca)
adf1<-ur.df(y = df_us$taux,type=c("trend"), lag=8, selectlags = c('AIC'))
summary(adf1)
```
La statistique du test ADF est égale à $t_{ADF}=-2.283$. Les seuils de rejet figurent sur la ligne tau3. La statistique de test $t_{ADF}$ est supérieure aux seuils de rejets pour les risques de première espèce de 1\%, 5\% et 10\%. On ne peut pas rejeter l'hypothèse nulle de racine unitaire.

Le t-stat de la tendance déterministe est égal à $t_{\hat{b}} = -0.155$. Le seuil de rejet qui figurent la table de $t_{\hat{b}}$ est égal à 3.14 pour un risque de première espèce de 5\%. on a donc $\vert t_{\hat{b}} \vert = 0.155 <3.14$ : on ne peut pas rejeter l'hypothèse nulle que la tendance déterministe n'est pas significative.

## Test ADF avec constante

```{r}
adf2<-ur.df(y = df_us$taux,type=c("drift"), lag=8, selectlags = c('AIC'))
summary(adf2)
```

a statistique du test ADF est égale à $t_{ADF}=-2.332$. Les seuils de rejet figurent sur la ligne tau3. La statistique de test $t_{ADF}$ est supérieure aux seuils de rejets pour les risques de première espèce de 1\%, 5\% et 10\%. On ne peut pas rejeter l'hypothèse nulle de racine unitaire.

Le t-stat de la constante est égal à $t_{\hat{c}} = 2.170$. Le seuil de rejet de la table de $t_{\hat{c}}$ est égal à 2.86 pour un risque de première espèce de 5\%. on a donc $\vert t_{\hat{c}} \vert = 2.170<2.86$ : on ne peut pas rejeter l'hypothèse nulle que la contante n'est pas significative.

## Test ADF sans constante ni tendance déterministe

```{r}
adf3<-ur.df(y = df_us$taux,type=c("none"), lag=8, selectlags = c('AIC'))
summary(adf3)
```
La statistique du test ADF est égale à $t_{ADF}=-0.874$. Les seuils de rejet figurent sur la ligne tau3. La statistique de test $t_{ADF}$ est supérieure aux seuils de rejets pour les risques de première espèce de 1\%, 5\% et 10\%. On ne peut pas rejeter l'hypothèse nulle de racine unitaire. On conclut que la série n'est pas stationnaire.

## Conclusion 
Les résultats des tests ADF nous amènent à conclure que la série du taux de chômage est une série DS sans tendance ni constante. On dit aussi qu'elle est un processus DS sans dérive (drift).



# Test de stationnarité de KPSS

On applique le test de stationnarité de KPSS. On présente les résultats du test avec une constante. La représentation graphique de la série et les conclusions du test ADF montrent que la taux de chômage ne contient pas de tendance déterministe.
```{r}
kpss_mu<-ur.kpss(y=df_us$taux,type="mu",lags="short")
summary(kpss_mu)
```
La statistique du test KPSS avec une constante est égale à $LM_{KPSS} = 0.2578$. Elle est inférieure au seuil de rejet à 5\% : $$ 0.2578<0.436$$ (et aussi à celle à 1%). On ne peut donc pas rejetter l'hypothèse de stationnarité du taux de chômage autour d'une constante. 


```{r}
kpss_tau<-ur.kpss(y=df_us$taux,type="tau",lags="short")
summary(kpss_tau)
```
# Conclusion générale sur les test de racine unitaire et de stationnarité
On voit que les conclusions des tests ADF et KPSS sont contradictoires en ce qui concerne la stationnarité du taux de chômage. Des études empiriques sur le taux de chômage aux Etats-Unis conclut à la stationnarité du taux de chômage  (Nelson and Plosser, 1982, Perron, 1988, Xiao and Phillips, 1997). On reviendra sur cette question lors l'étude de la modélisation du taux de chômage par un modèle ARMA (chapitre III).

# Tests sans la période Covid

On exclut les observations postérieures au premier semestre de l'année 2020. Les résultats des tests de racine unitaire et de stationnarité ne sont modifiés. On peut dire aussi qu'ils sont robustes à cette modification de la période de test.
```{r}
df_us_20Q1=df_us[df_us$Date<"2020-04-01",]
```


## Autocorrélogramme du taux de chômage

```{r}
acf_us_rate<-acf(x=df_us_20Q1$taux,main='Autocorrélogramme du taux de chômage des Etats-Unis')
acf_us_rate$acf
```
```{r}
pacf(x=df_us_20Q1$taux,main='Autocorrélogramme partiel du taux de chômage des Etats-Unis')
```

## Test de Dickey-Fuller augmenté
On applique le test ADF avec une tendance déterministe. Le nombre de retards maximum est fixé à 8 et le nombre de retards optimal est déterminé par la minimisation du critère AIC.
```{r}
library(urca)
adf1<-ur.df(y = df_us_20Q1$taux,type=c("trend"), lag=8, selectlags = c('AIC'))
summary(adf1)
```
La statistique du test ADF est égale à $t_{ADF}=-2.493$. Les seuils de rejet figurent sur la ligne tau3. La statistique de test $t_{ADF}$ est supérieure aux seuils de rejets pour les risques de première espèce de 1\%, 5\% et 10\%. On ne peut pas rejeter l'hypothèse nulle de racine unitaire.

Le t-stat de la tendance déterministe est égal à $t_{\hat{b}} = 0.297$. Le seuil de rejet qui figurent la table de $t_{\hat{b}}$ est égal à 3.14 pour un risque de première espèce de 5\%. on a donc $\vert t_{\hat{b}} \vert = 0.155 <3.14$ : on ne peut pas rejeter l'hypothèse nulle que la tendance déterministe n'est pas significative.

```{r}
adf2<-ur.df(y = df_us_20Q1$taux,type=c("drift"), lag=8, selectlags = c('AIC'))
summary(adf2)
```

a statistique du test ADF est égale à $t_{ADF}=-2.498$ les seuils de rejet figurent sur la ligne tau3. La statistique de test $t_{ADF}$ est supérieure aux seuils de rejets pour les risques de première espèce de 1\%, 5\% et 10\%. On ne peut pas rejeter l'hypothèse nulle de racine unitaire.

Le t-stat de la constante est égal à $t_{\hat{c}} = 2.377$. Le seuil de rejet de la table de $t_{\hat{c}}$ est égal à 2.86 pour un risque de première espèce de 5\%. on a donc $\vert t_{\hat{c}} \vert = 2.170<2.86$ : on ne peut pas rejeter l'hypothèse nulle que la contante n'est pas significative.

```{r}
adf3<-ur.df(y = df_us_20Q1$taux,type=c("none"), lag=8, selectlags = c('AIC'))
summary(adf3)
```
La statistique du test ADF est égale à $t_{ADF}=-0.758$. Les seuils de rejet figurent sur la ligne tau3. La statistique de test $t_{ADF}$ est supérieure aux seuils de rejets pour les risques de première espèce de 1\%, 5\% et 10\%. On ne peut pas rejeter l'hypothèse nulle de racine unitaire. On conclut que la série n'est pas stationnaire.

### Test de stationnarité de KPSS

On applique le test de stationnarité de KPSS. On présente les résultats du test avec une constante. La représentation graphique de la série et les conclusions du test ADF montrent que la taux de chômage ne contient pas de tendance déterministe. On ne rejette pas l'hypothèse nulle de stationnarité autour d'une constante. 
```{r}
kpss_mu<-ur.kpss(y=df_us_20Q1$taux,type="mu",lags="short")
summary(kpss_mu)
```